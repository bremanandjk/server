create table t1 (a int, b int);
create table t2 (c int, d int);
insert into t1 values (1,1),(2,2);
insert into t2 values (2,2),(3,3);

(select a,b from t1) except (select c,d from t2);
EXPLAIN (select a,b from t1) except (select c,d from t2);
EXPLAIN extended (select a,b from t1) except (select c,d from t2);
EXPLAIN extended select * from ((select a,b from t1) except (select c,d from t2)) a;
EXPLAIN format=json (select a,b from t1) except (select c,d from t2);

--replace_regex /"r_total_time_ms": [0-9]*[.]?[0-9]*/"r_total_time_ms": "REPLACED"/
ANALYZE format=json (select a,b from t1) except (select c,d from t2);
--replace_regex /"r_total_time_ms": [0-9]*[.]?[0-9]*/"r_total_time_ms": "REPLACED"/
ANALYZE format=json select * from ((select a,b from t1) except (select c,d from t2)) a;
select * from ((select a,b from t1) except (select c,d from t2)) a;

prepare stmt from "(select a,b from t1) except (select c,d from t2)";
execute stmt;
execute stmt;

prepare stmt from "select * from ((select a,b from t1) except (select c,d from t2)) a";
execute stmt;
execute stmt;

drop tables t1,t2;


select 1 as a from dual except select 1 from dual;
(select 1 from dual) except (select 1 from dual);
--error ER_WRONG_USAGE
(select 1 from dual into @v) except (select 1 from dual);
--error ER_PARSE_ERROR
select 1 from dual ORDER BY 1 except select 1 from dual;

select 1 as a from dual union all select 1 from dual;
--error ER_WRONG_USAGE
select 1 from dual except all select 1 from dual;


create table t1 (a int, b blob, a1 int, b1 blob);
create table t2 (c int, d blob, c1 int, d1 blob);
insert into t1 values (1,"ddd", 1, "sdfrrwwww"),(2, "fgh", 2, "dffggtt");
insert into t2 values (2, "fgh", 2, "dffggtt"),(3, "ffggddd", 3, "dfgg");

(select a,b,b1 from t1) except (select c,d,d1 from t2);
# make sure that blob is used
create table t3 (select a,b,b1 from t1) except (select c,d,d1 from t2);
show create table t3;

drop tables t1,t2,t3;
